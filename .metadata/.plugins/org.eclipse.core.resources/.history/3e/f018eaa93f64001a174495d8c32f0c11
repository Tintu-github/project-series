package tintu;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;

public class Exceltoweb {

	public static void main(String[] args) throws IOException {
    System.setProperty("webdriver.chrome.driver", "D:\\Selenium\\chromedriver.exe");
    WebDriver driver=new ChromeDriver();
    driver.get("http://tv.indusmis.in/Account/Login?ReturnUrl=%2F");
    //get data from excel sheet
    
    FileInputStream file=new FileInputStream("E:\\TINTU\\2019-20\\TV\\TrueValue SW\\tv password.xlsx");
    
    //get workbook instance for xlsx file
    XSSFWorkbook workbook=new XSSFWorkbook(file);
    XSSFSheet sheet=workbook.getSheet("Sheet2");
   
    int noofrow= sheet.getLastRowNum();
    System.out.println("no of rows are "+ noofrow);
    
    int col=sheet.getRow(4).getLastCellNum();
    System.out.println("no of columns  are "+ col);
    
    for (int i = 4; i < noofrow; i++)
    {
		XSSFRow currentrow=sheet.getRow(i);
	
		String USER_ID=currentrow.getCell(3).getStringCellValue();
		String password=currentrow.getCell(4).getStringCellValue();
    
			driver.findElement(By.id("Username")).sendKeys(USER_ID);
			driver.findElement(By.id("Password")).sendKeys(password);
			driver.findElement(By.xpath("//input[@class='btn loginBtn']")).click();
    }		
		
	}
    }
